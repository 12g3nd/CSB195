<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Srihith Jarabana">
<meta name="dcterms.date" content="2025-10-15">

<title>Report 1: Genetic Code Optimization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="GCO_files/libs/clipboard/clipboard.min.js"></script>
<script src="GCO_files/libs/quarto-html/quarto.js"></script>
<script src="GCO_files/libs/quarto-html/popper.min.js"></script>
<script src="GCO_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="GCO_files/libs/quarto-html/anchor.min.js"></script>
<link href="GCO_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="GCO_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="GCO_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="GCO_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="GCO_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#benchmark-standard-genetic-code-quality-score" id="toc-benchmark-standard-genetic-code-quality-score" class="nav-link active" data-scroll-target="#benchmark-standard-genetic-code-quality-score"><span class="header-section-number">1</span> Benchmark Standard Genetic Code Quality Score</a>
  <ul class="collapse">
  <li><a href="#load-required-packages" id="toc-load-required-packages" class="nav-link" data-scroll-target="#load-required-packages"><span class="header-section-number">1.1</span> Load Required Packages</a></li>
  <li><a href="#define-the-standard-genetic-code" id="toc-define-the-standard-genetic-code" class="nav-link" data-scroll-target="#define-the-standard-genetic-code"><span class="header-section-number">1.2</span> Define the Standard Genetic Code</a></li>
  <li><a href="#generate-codons" id="toc-generate-codons" class="nav-link" data-scroll-target="#generate-codons"><span class="header-section-number">1.3</span> Generate Codons</a></li>
  <li><a href="#define-a-function-to-get-neighbouring-codons" id="toc-define-a-function-to-get-neighbouring-codons" class="nav-link" data-scroll-target="#define-a-function-to-get-neighbouring-codons"><span class="header-section-number">1.4</span> Define a Function to Get Neighbouring Codons</a></li>
  <li><a href="#load-the-aasim-function" id="toc-load-the-aasim-function" class="nav-link" data-scroll-target="#load-the-aasim-function"><span class="header-section-number">1.5</span> Load the aaSim Function</a></li>
  <li><a href="#compute-the-benchmark" id="toc-compute-the-benchmark" class="nav-link" data-scroll-target="#compute-the-benchmark"><span class="header-section-number">1.6</span> Compute the Benchmark</a></li>
  </ul></li>
  <li><a href="#comparing-sgc-to-randomly-generated-genetic-codes" id="toc-comparing-sgc-to-randomly-generated-genetic-codes" class="nav-link" data-scroll-target="#comparing-sgc-to-randomly-generated-genetic-codes"><span class="header-section-number">2</span> Comparing SGC to Randomly Generated Genetic Codes</a>
  <ul class="collapse">
  <li><a href="#calculate-quality-score-for-any-genetic-code" id="toc-calculate-quality-score-for-any-genetic-code" class="nav-link" data-scroll-target="#calculate-quality-score-for-any-genetic-code"><span class="header-section-number">2.1</span> Calculate Quality Score for Any Genetic Code</a></li>
  <li><a href="#generating-10000-random-genetic-codes" id="toc-generating-10000-random-genetic-codes" class="nav-link" data-scroll-target="#generating-10000-random-genetic-codes"><span class="header-section-number">2.2</span> Generating 10,000 Random Genetic Codes</a></li>
  <li><a href="#statistical-analysis" id="toc-statistical-analysis" class="nav-link" data-scroll-target="#statistical-analysis"><span class="header-section-number">2.3</span> Statistical Analysis</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization"><span class="header-section-number">2.4</span> Visualization</a></li>
  <li><a href="#interpretation-and-summary" id="toc-interpretation-and-summary" class="nav-link" data-scroll-target="#interpretation-and-summary"><span class="header-section-number">2.5</span> Interpretation and Summary</a></li>
  <li><a href="#create-summary-table-for-report" id="toc-create-summary-table-for-report" class="nav-link" data-scroll-target="#create-summary-table-for-report"><span class="header-section-number">2.6</span> Create Summary Table for Report</a></li>
  </ul></li>
  <li><a href="#discussion-and-analysis" id="toc-discussion-and-analysis" class="nav-link" data-scroll-target="#discussion-and-analysis"><span class="header-section-number">3</span> Discussion and Analysis</a>
  <ul class="collapse">
  <li><a href="#brief-summary" id="toc-brief-summary" class="nav-link" data-scroll-target="#brief-summary"><span class="header-section-number">3.1</span> Brief Summary</a></li>
  <li><a href="#description-of-methods" id="toc-description-of-methods" class="nav-link" data-scroll-target="#description-of-methods"><span class="header-section-number">3.2</span> Description of Methods</a>
  <ul class="collapse">
  <li><a href="#clarifications-of-assumptions" id="toc-clarifications-of-assumptions" class="nav-link" data-scroll-target="#clarifications-of-assumptions"><span class="header-section-number">3.2.1</span> Clarifications of Assumptions</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology"><span class="header-section-number">3.2.2</span> Methodology</a></li>
  </ul></li>
  <li><a href="#description-of-results" id="toc-description-of-results" class="nav-link" data-scroll-target="#description-of-results"><span class="header-section-number">3.3</span> Description of Results</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion"><span class="header-section-number">3.4</span> Discussion</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">3.5</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">3.6</span> References</a></li>
  <li><a href="#appendix-a---implementation-details-reproducibility" id="toc-appendix-a---implementation-details-reproducibility" class="nav-link" data-scroll-target="#appendix-a---implementation-details-reproducibility"><span class="header-section-number">3.7</span> Appendix A - Implementation Details &amp; Reproducibility</a></li>
  <li><a href="#appendix-b---ai-usage-self-assessment" id="toc-appendix-b---ai-usage-self-assessment" class="nav-link" data-scroll-target="#appendix-b---ai-usage-self-assessment"><span class="header-section-number">3.8</span> Appendix B - AI Usage &amp; Self-Assessment</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Report 1: Genetic Code Optimization</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Srihith Jarabana </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 15, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="benchmark-standard-genetic-code-quality-score" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Benchmark Standard Genetic Code Quality Score</h1>
<blockquote class="blockquote">
<p>Implementation should be verified by calculating the “quality” of the Standard Genetic Code as a control</p>
</blockquote>
<section id="load-required-packages" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="load-required-packages"><span class="header-section-number">1.1</span> Load Required Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Biostrings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: BiocGenerics</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: generics</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'generics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.difftime, as.factor, as.ordered, intersect, is.element, setdiff,
    setequal, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'BiocGenerics'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    IQR, mad, sd, var, xtabs</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    anyDuplicated, aperm, append, as.data.frame, basename, cbind,
    colnames, dirname, do.call, duplicated, eval, evalq, Filter, Find,
    get, grep, grepl, is.unsorted, lapply, Map, mapply, match, mget,
    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
    rbind, Reduce, rownames, sapply, saveRDS, table, tapply, unique,
    unsplit, which.max, which.min</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: S4Vectors</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: stats4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'S4Vectors'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:utils':

    findMatches</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    expand.grid, I, unname</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: IRanges</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'IRanges'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:grDevices':

    windows</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: XVector</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: GenomeInfoDb</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Biostrings'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    strsplit</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For safe RNA→DNA conversion</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>rna_bases <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"U"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"G"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>dna_bases <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"T"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"G"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="define-the-standard-genetic-code" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="define-the-standard-genetic-code"><span class="header-section-number">1.2</span> Define the Standard Genetic Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the standard genetic code (DNA codons)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>stdGeneticCode <span class="ot">&lt;-</span> <span class="fu">getGeneticCode</span>(<span class="st">"Standard"</span>, <span class="at">full.search =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>stdGeneticCode</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TTT TTC TTA TTG TCT TCC TCA TCG TAT TAC TAA TAG TGT TGC TGA TGG CTT CTC CTA CTG 
"F" "F" "L" "L" "S" "S" "S" "S" "Y" "Y" "*" "*" "C" "C" "*" "W" "L" "L" "L" "L" 
CCT CCC CCA CCG CAT CAC CAA CAG CGT CGC CGA CGG ATT ATC ATA ATG ACT ACC ACA ACG 
"P" "P" "P" "P" "H" "H" "Q" "Q" "R" "R" "R" "R" "I" "I" "I" "M" "T" "T" "T" "T" 
AAT AAC AAA AAG AGT AGC AGA AGG GTT GTC GTA GTG GCT GCC GCA GCG GAT GAC GAA GAG 
"N" "N" "K" "K" "S" "S" "R" "R" "V" "V" "V" "V" "A" "A" "A" "A" "D" "D" "E" "E" 
GGT GGC GGA GGG 
"G" "G" "G" "G" 
attr(,"alt_init_codons")
[1] "TTG" "CTG"</code></pre>
</div>
</div>
</section>
<section id="generate-codons" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="generate-codons"><span class="header-section-number">1.3</span> Generate Codons</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate all possible RNA codons first</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>all_codons_rna <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(rna_bases, rna_bases, rna_bases)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>all_codons_rna <span class="ot">&lt;-</span> <span class="fu">apply</span>(all_codons_rna, <span class="dv">1</span>, paste0, <span class="at">collapse =</span> <span class="st">""</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert RNA codons to DNA codons (U → T)</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>all_codons <span class="ot">&lt;-</span> <span class="fu">chartr</span>(<span class="st">"U"</span>, <span class="st">"T"</span>, all_codons_rna)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>all_codons</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "TTT" "CTT" "ATT" "GTT" "TCT" "CCT" "ACT" "GCT" "TAT" "CAT" "AAT" "GAT"
[13] "TGT" "CGT" "AGT" "GGT" "TTC" "CTC" "ATC" "GTC" "TCC" "CCC" "ACC" "GCC"
[25] "TAC" "CAC" "AAC" "GAC" "TGC" "CGC" "AGC" "GGC" "TTA" "CTA" "ATA" "GTA"
[37] "TCA" "CCA" "ACA" "GCA" "TAA" "CAA" "AAA" "GAA" "TGA" "CGA" "AGA" "GGA"
[49] "TTG" "CTG" "ATG" "GTG" "TCG" "CCG" "ACG" "GCG" "TAG" "CAG" "AAG" "GAG"
[61] "TGG" "CGG" "AGG" "GGG"</code></pre>
</div>
</div>
</section>
<section id="define-a-function-to-get-neighbouring-codons" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="define-a-function-to-get-neighbouring-codons"><span class="header-section-number">1.4</span> Define a Function to Get Neighbouring Codons</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to generate all codons that differ by 1 nucleotide</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>get_neighbors <span class="ot">&lt;-</span> <span class="cf">function</span>(codon) {</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  bases <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>)  <span class="co"># DNA bases</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  codon_split <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(codon, <span class="st">""</span>)[[<span class="dv">1</span>]]</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  neighbors <span class="ot">&lt;-</span> <span class="fu">character</span>()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (b <span class="cf">in</span> bases) {</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (b <span class="sc">!=</span> codon_split[i]) {</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        neighbor <span class="ot">&lt;-</span> codon_split</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>        neighbor[i] <span class="ot">&lt;-</span> b</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>        neighbors <span class="ot">&lt;-</span> <span class="fu">c</span>(neighbors, <span class="fu">paste0</span>(neighbor, <span class="at">collapse =</span> <span class="st">""</span>))</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(neighbors)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Test example</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="fu">get_neighbors</span>(<span class="st">"ATG"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CTG" "GTG" "TTG" "AAG" "ACG" "AGG" "ATA" "ATC" "ATT"</code></pre>
</div>
</div>
</section>
<section id="load-the-aasim-function" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="load-the-aasim-function"><span class="header-section-number">1.5</span> Load the aaSim Function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download and load the prebuilt aaSim function</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>baseURL <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/hyginn/CSB195/main/"</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="st">"./dat/aaSim.4.1.Rds"</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the dat folder exists</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">"./dat"</span>)) <span class="fu">dir.create</span>(<span class="st">"./dat"</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the RDS file</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(fn)) <span class="fu">download.file</span>(<span class="fu">paste0</span>(baseURL, fn), fn, <span class="at">mode=</span><span class="st">"wb"</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the function</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>aaSim <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(fn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compute-the-benchmark" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="compute-the-benchmark"><span class="header-section-number">1.6</span> Compute the Benchmark</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize total score</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>total_score <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over all codons</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (codon <span class="cf">in</span> all_codons) {</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  aa1 <span class="ot">&lt;-</span> stdGeneticCode[codon]  <span class="co"># Original codon AA</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  neighbors <span class="ot">&lt;-</span> <span class="fu">get_neighbors</span>(codon)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (neighbor <span class="cf">in</span> neighbors) {</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    aa2 <span class="ot">&lt;-</span> stdGeneticCode[neighbor]</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    total_score <span class="ot">&lt;-</span> total_score <span class="sc">+</span> <span class="fu">aaSim</span>(aa1, aa2)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>total_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9856.116</code></pre>
</div>
</div>
</section>
</section>
<section id="comparing-sgc-to-randomly-generated-genetic-codes" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Comparing SGC to Randomly Generated Genetic Codes</h1>
<p>Now that the SGC matches the expected result, we can move on to comparing it to random generated genetic codes, or the first part of the report.</p>
<blockquote class="blockquote">
<p>Perform a computational experiment to compare the Standard Genetic Code with a large number of randomly generated codes, to assess whether it appears to have evolved under selection for such tolerance.</p>
</blockquote>
<section id="calculate-quality-score-for-any-genetic-code" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="calculate-quality-score-for-any-genetic-code"><span class="header-section-number">2.1</span> Calculate Quality Score for Any Genetic Code</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate total code quality score</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>calc_code_quality <span class="ot">&lt;-</span> <span class="cf">function</span>(genetic_code, aaSim) {</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  total_score <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  codons <span class="ot">&lt;-</span> <span class="fu">names</span>(genetic_code)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (codon <span class="cf">in</span> codons) {</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    aa1 <span class="ot">&lt;-</span> genetic_code[codon]</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="ot">&lt;-</span> <span class="fu">get_neighbors</span>(codon)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (neighbor <span class="cf">in</span> neighbors) {</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>      aa2 <span class="ot">&lt;-</span> genetic_code[neighbor]</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>      total_score <span class="ot">&lt;-</span> total_score <span class="sc">+</span> <span class="fu">aaSim</span>(aa1, aa2)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(total_score)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="generating-10000-random-genetic-codes" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="generating-10000-random-genetic-codes"><span class="header-section-number">2.2</span> Generating 10,000 Random Genetic Codes</h2>
<blockquote class="blockquote">
<p>Each generated code must map 64 codons to all 20 amino acids, and at least one stop codon.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>aa_alphabet <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"C"</span>,<span class="st">"D"</span>,<span class="st">"E"</span>,<span class="st">"F"</span>,<span class="st">"G"</span>,<span class="st">"H"</span>,<span class="st">"I"</span>,<span class="st">"K"</span>,<span class="st">"L"</span>,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"M"</span>,<span class="st">"N"</span>,<span class="st">"P"</span>,<span class="st">"Q"</span>,<span class="st">"R"</span>,<span class="st">"S"</span>,<span class="st">"T"</span>,<span class="st">"V"</span>,<span class="st">"W"</span>,<span class="st">"Y"</span>,<span class="st">"*"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>generate_random_code <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  codons <span class="ot">&lt;-</span> <span class="fu">names</span>(stdGeneticCode)  <span class="co"># 64 DNA codons</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  aa_letters <span class="ot">&lt;-</span> aa_alphabet[<span class="sc">-</span><span class="dv">21</span>]   <span class="co"># first 20 are amino acids</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  stop_codon <span class="ot">&lt;-</span> <span class="st">"*"</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pick 1 codon as stop</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  stop_pos <span class="ot">&lt;-</span> <span class="fu">sample</span>(codons, <span class="dv">1</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  remaining_codons <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(codons, stop_pos)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign remaining codons randomly to the 20 amino acids</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  remaining_aas <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(aa_letters, <span class="at">length.out =</span> <span class="fu">length</span>(remaining_codons)))</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  random_code <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">setNames</span>(stop_codon, stop_pos), <span class="fu">setNames</span>(remaining_aas, remaining_codons))</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(random_code)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="statistical-analysis" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="statistical-analysis"><span class="header-section-number">2.3</span> Statistical Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>num_random <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>random_scores <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_random)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_random) {</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  rand_code <span class="ot">&lt;-</span> <span class="fu">generate_random_code</span>()</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  random_scores[i] <span class="ot">&lt;-</span> <span class="fu">calc_code_quality</span>(rand_code, aaSim)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">%%</span> <span class="dv">1000</span> <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">cat</span>(<span class="st">"Processed"</span>, i, <span class="st">"codes</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Processed 1000 codes
Processed 2000 codes
Processed 3000 codes
Processed 4000 codes
Processed 5000 codes
Processed 6000 codes
Processed 7000 codes
Processed 8000 codes
Processed 9000 codes
Processed 10000 codes</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SGC score</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>sgc_score <span class="ot">&lt;-</span> <span class="fu">calc_code_quality</span>(stdGeneticCode, aaSim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualization" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="visualization"><span class="header-section-number">2.4</span> Visualization</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">score=</span>random_scores), <span class="fu">aes</span>(<span class="at">x=</span>score)) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">50</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>sgc_score, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">size=</span><span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Distribution of Genetic Code Quality Scores"</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Code Quality Score"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span>sgc_score, <span class="at">y=</span><span class="fu">max</span>(<span class="fu">table</span>(<span class="fu">cut</span>(random_scores, <span class="at">breaks=</span><span class="dv">50</span>)))<span class="sc">*</span><span class="fl">0.9</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">label=</span><span class="st">"SGC"</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">angle=</span><span class="dv">90</span>, <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="GCO_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CDF for percentile calculation</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">score=</span>random_scores), <span class="fu">aes</span>(<span class="at">x=</span>score)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">geom=</span><span class="st">"step"</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>sgc_score, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"CDF of Random Genetic Code Scores"</span>, <span class="at">x=</span><span class="st">"Score"</span>, <span class="at">y=</span><span class="st">"CDF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="GCO_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-and-summary" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="interpretation-and-summary"><span class="header-section-number">2.5</span> Interpretation and Summary</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>sgc_percentile <span class="ot">&lt;-</span> <span class="fu">mean</span>(random_scores <span class="sc">&lt;=</span> sgc_score) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>sgc_percentile</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="create-summary-table-for-report" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="create-summary-table-for-report"><span class="header-section-number">2.6</span> Create Summary Table for Report</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>summary_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"SGC Score"</span>, <span class="st">"Random Mean"</span>, <span class="st">"Random SD"</span>, <span class="st">"SGC Percentile"</span>),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    sgc_score,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(random_scores),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(random_scores),</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    sgc_percentile</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>summary_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Metric      Value
1      SGC Score  9856.1163
2    Random Mean 12729.7031
3      Random SD   223.7533
4 SGC Percentile     0.0000</code></pre>
</div>
</div>
</section>
</section>
<section id="discussion-and-analysis" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Discussion and Analysis</h1>
<p>Now, that the tests have been successfully run, we can look into what they mean.</p>
<blockquote class="blockquote">
<p>Discuss how close to a global optimum in this respect the Standard Genetic Code might be, and discuss limitations of your experiment in reaching your conclusions.</p>
</blockquote>
<section id="brief-summary" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="brief-summary"><span class="header-section-number">3.1</span> Brief Summary</h2>
<ul>
<li><strong>Objective</strong> is to evaluate whether the universal genetic code is the best it can be.
<ul>
<li>Essentially, test whether the Standard Genetic Code is optimized to be tolerant of single-nucleotide point mutations by comparing its total amino-acid distance score (using the aaSim function) to a large sample of (10,000) randomly generated alternative codes which are then put through the same test.</li>
</ul></li>
<li><strong>Metric</strong> is total code score which is the sum of <code>aaSim(aa1, aa2)</code> over all 64 codons × 9 single-nucleotide neighbors (576 comparisons).
<ul>
<li>Two amino acids have a smaller score, thus a lower overall score means more that the genetic code tested is more tolerant.</li>
</ul></li>
<li><strong>Main finding</strong> that has been computed is the SGC total score and is compared against random codes and plotted visually to contextualize findings.</li>
</ul>
</section>
<section id="description-of-methods" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="description-of-methods"><span class="header-section-number">3.2</span> Description of Methods</h2>
<section id="clarifications-of-assumptions" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="clarifications-of-assumptions"><span class="header-section-number">3.2.1</span> Clarifications of Assumptions</h3>
<blockquote class="blockquote">
<p>How to define a computable measure of tolerance of point mutations</p>
</blockquote>
<ul>
<li><p>Measured a computation mutation tolerance (“quality” score) by simulating single-nucleotide (i.e.&nbsp;point) mutations in codons and then calculating how often these mutations lead to a change in the amino acid itself.</p></li>
<li><p>Essentially, measure was computationally figured out by counting how robust each genetic code is against single-base changes.</p></li>
<li><p>Use of the aaSim function that “computes pairwise amino acid distances” (Steipe 2025).</p></li>
</ul>
<blockquote class="blockquote">
<p>How to create valid alternative codes that respect the requirements of biology that are not part of the code itself – here one needs to distinguish between causes that shaped the code from consequences of its structure</p>
</blockquote>
<ul>
<li><p>Biological completeness was assured due to the use of all 20 amino acids.</p></li>
<li><p>Script randomized codon assignments while maintaining that each codon still mapped to a valid amino acid.</p></li>
<li><p>The randomization respected basic biological constraints.</p>
<ul>
<li>i.e., codons remained 3-letter combinations of A, T, G, C, and stop codons were preserved.</li>
</ul></li>
</ul>
<blockquote class="blockquote">
<p>How to conduct your computational experiment, including the design of positive and negative controls if necessary</p>
</blockquote>
<ul>
<li><p>Calculated the quality score for the the real (standard) genetic code and a set of 10,000 randomized alternative codes.</p></li>
<li><p>Then compared their scores to see if the natural code performed better than the random ones.</p></li>
<li><p>Standard genetic code acted as the “test” case and the randomly generated genetic codes implicitly acted as the negative control.</p></li>
</ul>
</section>
<section id="methodology" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="methodology"><span class="header-section-number">3.2.2</span> Methodology</h3>
<ol type="1">
<li><p>Define a measure of mutation tolerance (“quality”)</p>
<p>a. Used the aaSim() function to compute how tolerant a genetic code is to single-nucleotide (point) mutations.</p>
<p>b. Function checks the similarity between amino acids coming from all possible single-base substitutions in the codons.</p>
<p>c. Then outputs a measure of how often mutations lead to similar/identical amino acids (higher values indicate greater tolerance).</p></li>
<li><p>Load the standard genetic code</p>
<p>a. The standard genetic code was used as the baseline for comparison.</p>
<p>b. This code maps 64 codons to 20 amino acids and stop codons as per assignment guidelines.</p></li>
<li><p>Generate alternative randomized genetic codes</p>
<p>a. Randomized versions of the genetic code were created while making sure that they are biological valid.</p>
<p>b. Ensured that:</p>
<ul>
<li><p>All 20 amino acids were still represented.</p></li>
<li><p>Stop codons remained correctly assigned.</p></li>
<li><p>Codon structure (i.e.&nbsp;triplet format) was maintained.</p></li>
</ul>
<p>c. This created “valid alternative codes” for comparison.</p></li>
<li><p>Compute tolerance of point mutations across all codes</p>
<p>a. Applied aaSim() to each alternative code and to the standard code.</p>
<p>b. Calculated the mean similarity score for all possible point mutations in each code.</p>
<p>c. This produced a distribution of tolerance scores for random codes.</p></li>
<li><p>Compare the standard code to alternatives</p>
<p>a. Compared the standard code’s tolerance score to the distribution of scores from the randomized codes using a special marker in the figures.</p>
<p>b. Evaluated whether the natural code showed rather high tolerance, suggesting optimization.</p></li>
<li><p>Experimental controls</p>
<p>a. The standard genetic code served as the test case.</p>
<p>b. The randomized codes served as negative controls to establish a baseline to compare it against.</p></li>
</ol>
<p><strong>See Appendix A for more details</strong></p>
</section>
</section>
<section id="description-of-results" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="description-of-results"><span class="header-section-number">3.3</span> Description of Results</h2>
<ul>
<li><p>The total quality score for the Standard Genetic Code (SGC) was <strong>9856.116</strong>.</p>
<ul>
<li><p>This score was computed using the <code>aaSim</code> similarity function, which quantifies the similarity between two amino acids as “the Euclidian distance between their positions in an amino acid feature space” (Steipe 2025).</p></li>
<li><p>A lower score indicates greater robustness (i.e., higher tolerance to point mutations).</p></li>
</ul></li>
<li><p>A total of 10,000 random genetic codes were generated by randomizing amino acid assignments while maintaining biological constraints (same codon count, all amino acids represented).</p></li>
<li><p>The <strong>mean score</strong> of these random codes was <strong>12729.7031</strong>, with a standard deviation of 223.7533.</p></li>
<li><p>The Standard Genetic Code’s score (9856.116) was lower than any of the 10,000 random codes tested.</p>
<ul>
<li>This places the SGC below the 0th percentile of the distribution; it is more optimized than 100% of the random codes generated.</li>
</ul></li>
<li><p>The histogram and cumulative distribution function (CDF) visualizations likewise showcase that the SGC’s score lies far to the left of the random distribution, emphasizing its exceptional optimization compared to chance and randomness.</p></li>
<li><p>In brief, these results support the hypothesis that the genetic code is non-randomly optimized to strongly minimize the harmful effects of point mutations.</p></li>
</ul>
</section>
<section id="discussion" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="discussion"><span class="header-section-number">3.4</span> Discussion</h2>
<ul>
<li><p>These results suggest that the SGC is not a random outcome (such as that all living life had it randomly selected and kept it) but rather a product of evolutionary optimization where it has become more efficient over time.</p></li>
<li><p>Scientific literature often supports these findings as many show how the SGC minimizes translation errors and the biochemical impact of point mutations far better than most possible genetic codes.</p></li>
<li><p>For instance, works by S.J. Freeland and L.D. Hurst demonstrated that the SGC ranks within the top of all possible genetic codes in minimizing the effects of amino acid substitutions (Freeland and Hurst 1998).</p>
<ul>
<li><p>Freeland and Hurst also described the matter that all naturally occurring variant genetic codes (that evolved later in the timeline) appear less optimized than the standard code suggesting that perhaps the element of time plays an exceptional role in the SGC’s optimization.</p></li>
<li><p>These findings continue to reinforce the concept that the genetic code likely evolved under selective pressure, allowing organisms such as ourselves to tolerate mutations without catastrophic impacts on protein structure or function.</p></li>
</ul></li>
</ul>
<!-- -->
<ul>
<li><p>In another study by Steven Massey, the genetic code’s point tolerance structure (which minimizes damage due to mutations) may have arisen without direct selective pressures (Massey 2015).</p>
<ul>
<li><p>Through simulations, Massey shows that error minimization could emerge naturally during code expansion.</p></li>
<li><p>This is interesting as it changes the way we think about how optimization occurs, leading to various new ideas that future experiments could explore further.</p></li>
</ul></li>
<li><p>However, the experiment also has limitations. The <code>aaSim</code> metric captures only one measure between amino acids but does not account for other biological factors (e.g.&nbsp;tRNA abundance) which may influence mutation tolerance in reality.</p></li>
</ul>
<!-- -->
<ul>
<li>Additionally, only single-point mutations were considered. In nature, multiple-nucleotide changes can alter how mutation effects work, which future studies could incorporate using more complex evolutionary models and computational power.</li>
</ul>
<!-- -->
<ul>
<li>One notable thought is the use of a positive control (a theoretically “perfect” genetic code) and how the SGC compares to it and what is different between them.</li>
</ul>
</section>
<section id="conclusion" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">3.5</span> Conclusion</h2>
<ul>
<li>The experiment successfully quantified the tolerance of point mutations of the Standard Genetic Code (SGC) using a similarity measure (aaSim).</li>
</ul>
<!-- -->
<ul>
<li><p>By comparing the SGC’s total score (9856.116) with 10,000 randomized alternative genetic codes, it was found that none of the random codes had greater optimization.</p>
<ul>
<li>This result places the SGC at the extreme lower end of the distribution, indicating that it is more optimized than all randomly generated alternatives under the same restrictions.</li>
</ul></li>
</ul>
<!-- -->
<ul>
<li>The resulst highlight strong evidence that the structure of the genetic code is highly non-random, having evolved to minimize the impact of point mutations on function.</li>
</ul>
<!-- -->
<ul>
<li><p>Overall, the Standard Genetic Code demonstrates both efficiency and evolutionary optimization, supporting the current broader hypothesis that natural selection favoured genetic codes that provide error tolerance and stability.</p></li>
<li><p>However, this experiment still has various limitations and should be taken as just one part of a larger system to figure out whether the SGC is the peak of biological optimization.</p></li>
</ul>
</section>
<section id="references" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="references"><span class="header-section-number">3.6</span> References</h2>
<p>Freeland, Stephen J., Robin D. Knight, Laura F. Landweber, and Laurence D. Hurst. 2000. <a href="https://pubmed.ncbi.nlm.nih.gov/10742043/">“Early Fixation of an Optimal Genetic Code.”</a> <em>Molecular Biology and Evolution</em> 17, no. 4: 511-518.</p>
<p>Massey, Steven E. 2015. <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC4500140/">“Genetic Code Evolution Reveals the Neutral Emergence of Mutational Robustness, and Information as an Evolutionary Constraint.”</a> <em>Life</em> 5, no. 2: 1301-1332.</p>
<p>Hyginn. n.d. “Computing Amino Acid Similarity.” GitHub repository, CSB195. Accessed October 12, 2025. <a href="https://github.com/hyginn/CSB195/blob/main/src/qmd/computingAminoAcidSimilarity.qmd" class="uri">https://github.com/hyginn/CSB195/blob/main/src/qmd/computingAminoAcidSimilarity.qmd</a>.</p>
</section>
<section id="appendix-a---implementation-details-reproducibility" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="appendix-a---implementation-details-reproducibility"><span class="header-section-number">3.7</span> Appendix A - Implementation Details &amp; Reproducibility</h2>
<ul>
<li><p>Manually created the Quarto document in RStudio, typing all text while allowing AI to only input the R code itself.</p>
<ul>
<li>This includes formatting (e.g.&nbsp;headers, code text, bolding text, etc.).</li>
</ul></li>
<li><p>The reproducibility includes <code>set.seed(123)</code> used for all sampling; aaSim.4.1.Rds included in ./dat/ and referenced via <code>readRDS()</code>.</p></li>
<li><p>Included an additional section titled “Discussion” to help discuss important limitations and research currently present in the field.</p></li>
</ul>
</section>
<section id="appendix-b---ai-usage-self-assessment" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="appendix-b---ai-usage-self-assessment"><span class="header-section-number">3.8</span> Appendix B - AI Usage &amp; Self-Assessment</h2>
<ul>
<li><p>AI assistance</p>
<ul>
<li><p>ChatGPT (GPT-5)</p>
<ul>
<li>Produce and debug R code</li>
</ul></li>
<li><p>Gemini 2.5 Flash</p>
<ul>
<li><p>Discuss interesting perspectives regarding limitations</p></li>
<li><p>Supplied further readings and discussions to discuss the results</p></li>
</ul></li>
</ul></li>
<li><p>Self-assessment based on course rubric</p>
<ul>
<li><p>Collaborative improvement: excellent</p>
<ul>
<li><p>I am not familiar with either R, so I used AI to help write code and fix the numerous errors that arrived.</p></li>
<li><p>Implemented the code accurately and fixed syntax errors personally.</p></li>
<li><p>Instructed the AI to do what I required instead of relying on it to complete the entire assignment.</p></li>
</ul></li>
<li><p>Knowledge accuracy &amp; sources: outstanding</p>
<ul>
<li>I am a commerce student with essentially no strong biology background and have not studied it in two years, so a course such as Computational Biology seems very out-of-scope but I still inquired excessively regarding the context and furthered studied many papers, even citing them.</li>
</ul></li>
<li><p>Autonomous voice: excellent</p>
<ul>
<li><p>I thought with the AI rather than have AI think for me by consistently asking questions and analyzing the code.</p></li>
<li><p>Clarified when I was confused or wanted to learn more and asked the AI to build the code according to my specifications rather than have it do it for me.</p></li>
</ul></li>
<li><p>Suggested mark: <strong>90%</strong></p></li>
</ul></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>